<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Productivity Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      text-align: center;
    }

    .container {
      margin: 50px auto;
      max-width: 600px;
    }

    input[type="file"], select, button {
      padding: 10px;
      margin-bottom: 20px;
    }

    table {
      margin-top: 20px;
      width: 100%;
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid black;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    .message {
      margin-top: 20px;
      color: green;
    }

    .high {
      background-color: green;
      color: white;
    }

    .medium {
      background-color: orange;
      color: white;
    }

    .low {
      background-color: red;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Upload Staff Productivity CSV</h1>

    <!-- CSV File Upload Form -->
    <input type="file" id="fileInput" accept=".csv" />
    <button id="uploadBtn" disabled>Upload CSV</button>

    <!-- Date Range Selection -->
    <div id="dateRangeSection" style="display: none;">
      <h3>Select Date Range</h3>
      <label for="startDate">From:</label>
      <input type="date" id="startDate">
      <label for="endDate">To:</label>
      <input type="date" id="endDate">
      <button id="filterBtn">Apply Date Filter</button>
    </div>

    <!-- Report Type Selection -->
    <div id="reportSection" style="display: none;">
      <h3>Select Report Type</h3>
      <button id="productivityBtn">Productivity Report</button>
      <button id="overtimeBtn">Overtime Report</button>
    </div>

    <!-- Confirmation Message -->
    <div id="confirmationMessage" class="message"></div>

    <!-- Pivot Table Section -->
    <div id="pivotTableSection" style="display: none;">
      <h3>Productivity Report</h3>
      <table id="pivotTable"></table>
    </div>

    <!-- Admin Report Section -->
    <div id="adminReportSection" style="display: none;">
      <h3>Admin Overtime Report</h3>
      <table id="adminReportTable"></table>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById("fileInput");
    const uploadBtn = document.getElementById("uploadBtn");
    const confirmationMessage = document.getElementById("confirmationMessage");
    const dateRangeSection = document.getElementById("dateRangeSection");
    const reportSection = document.getElementById("reportSection");
    const startDateInput = document.getElementById("startDate");
    const endDateInput = document.getElementById("endDate");
    const pivotTableSection = document.getElementById("pivotTableSection");
    const adminReportSection = document.getElementById("adminReportSection");

    let csvData = [];

    // Enable the upload button when a file is selected
    fileInput.addEventListener("change", function () {
      if (fileInput.files.length > 0) {
        uploadBtn.disabled = false;
      } else {
        uploadBtn.disabled = true;
      }
    });

    // Handle file upload
    uploadBtn.addEventListener("click", function () {
      const file = fileInput.files[0];

      if (file.type === "text/csv") {
        const reader = new FileReader();

        reader.onload = function (e) {
          const text = e.target.result;
          parseCSV(text); // Parse the CSV content

          confirmationMessage.innerHTML = `File "<strong>${file.name}</strong>" uploaded successfully. Please select a date range.`;
          confirmationMessage.style.color = "green";

          // Show date range selection
          dateRangeSection.style.display = "block";
        };

        reader.readAsText(file); // Read the file content
      } else {
        confirmationMessage.innerHTML = "Please upload a valid CSV file.";
        confirmationMessage.style.color = "red";
      }
    });

    // Parse the CSV file and extract the data
    function parseCSV(csvText) {
      const lines = csvText.split("\n");
      csvData = lines.map(line => line.split(","));
      
      // Assuming first row is the header
      const header = csvData[0];
      csvData = csvData.slice(1); // Skip header row
    }

    // Filter the data and prepare the report
    function generatePivotTable() {
      // TODO: Add pivot table generation logic here
    }

    function generateOvertimeReport() {
      // TODO: Add overtime report generation logic here
    }

    // Show the report options after applying the date filter
    document.getElementById("filterBtn").addEventListener("click", function () {
      const startDate = new Date(startDateInput.value);
      const endDate = new Date(endDateInput.value);

      if (startDate && endDate && startDate <= endDate) {
        confirmationMessage.innerHTML = "Date filter applied. Select a report type.";
        confirmationMessage.style.color = "blue";
        reportSection.style.display = "block";
      } else {
        confirmationMessage.innerHTML = "Please select a valid date range.";
        confirmationMessage.style.color = "red";
      }
    });

    // Generate the selected report
    document.getElementById("productivityBtn").addEventListener("click", function () {
      pivotTableSection.style.display = "block";
      generatePivotTable();
    });

    document.getElementById("overtimeBtn").addEventListener("click", function () {
      adminReportSection.style.display = "block";
      generateOvertimeReport();
    });
  </script>
</body>
</html>
